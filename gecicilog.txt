poetry run python -X utf8 launch_camoufox.py --debug --stream-port 0
2025-10-06 23:37:38,065 - INFO - ============================== Camoufoxå¯åŠ¨å™¨æ—¥å¿—ç³»ç»Ÿå·²åˆå§‹åŒ– ==============================
2025-10-06 23:37:38,066 - INFO - æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º: INFO
2025-10-06 23:37:38,066 - INFO - æ—¥å¿—æ–‡ä»¶è·¯å¾„: C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\logs\launch_app.log
2025-10-06 23:37:38,068 - INFO - æ ¹æ®å½“å‰ç³»ç»Ÿ 'Windows'ï¼ŒCamoufox OS æ¨¡æ‹Ÿå·²è‡ªåŠ¨è®¾ç½®ä¸º: windows
2025-10-06 23:37:38,069 - INFO - ğŸš€ Camoufox å¯åŠ¨å™¨å¼€å§‹è¿è¡Œ ğŸš€
2025-10-06 23:37:38,070 - INFO - =================================================
2025-10-06 23:37:38,070 - INFO - æ­£åœ¨æ£€æŸ¥å¹¶ç¡®ä¿è®¤è¯æ–‡ä»¶ç›®å½•å­˜åœ¨...
2025-10-06 23:37:38,071 - INFO -   âœ“ æ´»åŠ¨è®¤è¯ç›®å½•å°±ç»ª: C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\auth_profiles\active
2025-10-06 23:37:38,071 - INFO -   âœ“ å·²ä¿å­˜è®¤è¯ç›®å½•å°±ç»ª: C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\auth_profiles\saved
2025-10-06 23:37:38,071 - INFO - --- æ­¥éª¤ 1: æ£€æŸ¥ä¾èµ–é¡¹ ---
2025-10-06 23:37:38,071 - INFO - æ­£åœ¨æ£€æŸ¥ Python æ¨¡å—:
2025-10-06 23:37:38,072 - INFO -   âœ“ æ¨¡å— 'camoufox' å·²æ‰¾åˆ°ã€‚
2025-10-06 23:37:38,072 - INFO -   âœ“ æˆåŠŸä» 'server.py' å¯¼å…¥ 'app' å¯¹è±¡ã€‚
2025-10-06 23:37:38,072 - INFO - âœ… æ‰€æœ‰å¯åŠ¨å™¨ä¾èµ–é¡¹æ£€æŸ¥é€šè¿‡ã€‚
2025-10-06 23:37:38,072 - INFO - =================================================
2025-10-06 23:37:38,072 - INFO - æœ€ç»ˆé€‰æ‹©çš„å¯åŠ¨æ¨¡å¼: debugæ¨¡å¼
2025-10-06 23:37:38,072 - INFO - -------------------------------------------------
  æ˜¯å¦è¦åˆ›å»ºå¹¶ä¿å­˜æ–°çš„è®¤è¯æ–‡ä»¶? (y/n; é»˜è®¤: n, 15sè¶…æ—¶): n
2025-10-06 23:37:39,633 - INFO -   å¥½çš„ï¼Œå°†ä¸åˆ›å»ºæ–°çš„è®¤è¯æ–‡ä»¶ã€‚
2025-10-06 23:37:39,633 - INFO - --- æ­¥éª¤ 2: æ£€æŸ¥ FastAPI æœåŠ¡å™¨ç›®æ ‡ç«¯å£ (2048) æ˜¯å¦è¢«å ç”¨ ---
2025-10-06 23:37:39,634 - INFO -   âœ… ç«¯å£ 2048 (ä¸»æœº 0.0.0.0) å½“å‰å¯ç”¨ã€‚
2025-10-06 23:37:39,634 - INFO - --- æ­¥éª¤ 3: å‡†å¤‡å¹¶å¯åŠ¨ Camoufox å†…éƒ¨è¿›ç¨‹ ---
2025-10-06 23:37:39,634 - INFO -   è°ƒè¯•æ¨¡å¼: æ‰«æå…¨ç›®å½•å¹¶æç¤ºç”¨æˆ·ä»å¯ç”¨è®¤è¯æ–‡ä»¶ä¸­é€‰æ‹©...
------------------------------------------------------------
   æ‰¾åˆ°ä»¥ä¸‹å¯ç”¨çš„è®¤è¯æ–‡ä»¶:
     1: active/qwen.json
     2: saved/qwen.json
     N: ä¸åŠ è½½ä»»ä½•æ–‡ä»¶ (ä½¿ç”¨æµè§ˆå™¨å½“å‰çŠ¶æ€)
------------------------------------------------------------
   è¯·é€‰æ‹©è¦åŠ è½½çš„è®¤è¯æ–‡ä»¶ç¼–å· (è¾“å…¥ N æˆ–ç›´æ¥å›è½¦åˆ™ä¸åŠ è½½, 30sè¶…æ—¶): 1
2025-10-06 23:37:43,626 - INFO -    å·²é€‰æ‹©åŠ è½½è®¤è¯æ–‡ä»¶: active/qwen.json
   å·²é€‰æ‹©åŠ è½½: active/qwen.json
------------------------------------------------------------
2025-10-06 23:37:43,626 - INFO -   å°†æ‰§è¡Œ Camoufox å†…éƒ¨å¯åŠ¨å‘½ä»¤: C:\Users\mansi\AppData\Local\pypoetry\Cache\virtualenvs\aistudioproxyapi-AmwmgP_5-py3.12\Scripts\python.exe -u C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\launch_camoufox.py --internal-launch-mode debug --internal-auth-file C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\auth_profiles\active\qwen.json --internal-camoufox-os windows --internal-camoufox-port 9222
2025-10-06 23:37:43,630 - INFO -   Camoufox å†…éƒ¨è¿›ç¨‹å·²å¯åŠ¨ (PID: 93380)ã€‚æ­£åœ¨ç­‰å¾… WebSocket ç«¯ç‚¹è¾“å‡º (æœ€é•¿ 45 ç§’)...
2025-10-06 23:37:45,134 - INFO - [InternalCamoufox-stdout-PID:93380]: --- [å†…éƒ¨Camoufoxå¯åŠ¨] ä»£ç†é…ç½®: æ— ä»£ç† ---
2025-10-06 23:37:45,134 - INFO - [InternalCamoufox-stdout-PID:93380]: --- [å†…éƒ¨Camoufoxå¯åŠ¨] æ¨¡å¼: debug, è®¤è¯æ–‡ä»¶: qwen.json, Camoufoxç«¯å£: 9222, ä»£ç†: æ— , æ¨¡æ‹ŸOS: windows ---
2025-10-06 23:37:45,134 - INFO - [InternalCamoufox-stdout-PID:93380]: --- [å†…éƒ¨Camoufoxå¯åŠ¨] æ­£åœ¨è°ƒç”¨ camoufox.server.launch_server ... ---
2025-10-06 23:37:45,135 - INFO - [InternalCamoufox-stdout-PID:93380]:   ä¼ é€’ç»™ launch_server çš„å‚æ•°: {'port': 9222, 'addons': [], 'exclude_addons': [<DefaultAddons.UBO: 'https://addons.mozilla.org/firefox/downloads/latest/ublock-origin/latest.xpi'>], 'window': (1440, 900), 'storage_state': 'C:\\Users\\mansi\\new\\gorursunuzsiz\\AIstudioProxyAPI\\auth_profiles\\active\\qwen.json', 'os': 'windows'}
2025-10-06 23:37:45,715 - INFO - [InternalCamoufox-stdout-PID:93380]: Launching server...
2025-10-06 23:37:49,165 - INFO - [InternalCamoufox-stdout-PID:93380]: Server launched: 3.451s
2025-10-06 23:37:49,165 - INFO - [InternalCamoufox-stdout-PID:93380]: Websocket endpoint: ws://localhost:9222/324a9b936b146bf616b2a4f54ac170a7
2025-10-06 23:37:49,165 - INFO -   âœ… æˆåŠŸä» Camoufox å†…éƒ¨è¿›ç¨‹æ•è·åˆ° WebSocket ç«¯ç‚¹: ws://localhost:9222/324a9b936b146bf616b2...
2025-10-06 23:37:51,182 - INFO -   Helper æ¨¡å¼å·²é€šè¿‡ --helper='' ç¦ç”¨ã€‚
2025-10-06 23:37:51,182 - INFO - --- æ­¥éª¤ 4: è®¾ç½®ç¯å¢ƒå˜é‡å¹¶å‡†å¤‡å¯åŠ¨ FastAPI/Uvicorn æœåŠ¡å™¨ ---
2025-10-06 23:37:51,183 - INFO -   ä¸º server.app è®¾ç½®çš„ç¯å¢ƒå˜é‡:
2025-10-06 23:37:51,183 - INFO -     CAMOUFOX_WS_ENDPOINT=ws://localhost:9222/324a9b936b146bf616b2...
2025-10-06 23:37:51,183 - INFO -     LAUNCH_MODE=debug
2025-10-06 23:37:51,184 - INFO -     SERVER_LOG_LEVEL=DEBUG
2025-10-06 23:37:51,184 - INFO -     SERVER_REDIRECT_PRINT=false
2025-10-06 23:37:51,184 - INFO -     DEBUG_LOGS_ENABLED=false
2025-10-06 23:37:51,184 - INFO -     TRACE_LOGS_ENABLED=false
2025-10-06 23:37:51,184 - INFO -     ACTIVE_AUTH_JSON_PATH=qwen.json
2025-10-06 23:37:51,185 - INFO -     AUTO_SAVE_AUTH=false
2025-10-06 23:37:51,185 - INFO -     SAVE_AUTH_FILENAME=
2025-10-06 23:37:51,185 - INFO -     AUTH_SAVE_TIMEOUT=30
2025-10-06 23:37:51,185 - INFO -     SERVER_PORT_INFO=2048
2025-10-06 23:37:51,185 - INFO -     HOST_OS_FOR_SHORTCUT=Windows
2025-10-06 23:37:51,185 - INFO -     HELPER_ENDPOINT= (æœªè®¾ç½®)
2025-10-06 23:37:51,186 - INFO -     HELPER_SAPISID= (æœªè®¾ç½®)
2025-10-06 23:37:51,186 - INFO -     STREAM_PORT=0
2025-10-06 23:37:51,186 - INFO -     UNIFIED_PROXY_CONFIG= (æœªè®¾ç½®)
2025-10-06 23:37:51,186 - INFO - --- æ­¥éª¤ 5: å¯åŠ¨é›†æˆçš„ FastAPI æœåŠ¡å™¨ (ç›‘å¬ç«¯å£: 2048) ---
--- server.py çš„ print è¾“å‡ºæœªè¢«é‡å®šå‘åˆ°æ—¥å¿—ç³»ç»Ÿ (å°†ä½¿ç”¨åŸå§‹ stdout/stderr) ---
2025-10-06 23:37:51,224 - INFO [SERVER] - ===== AIStudioProxyServer æ—¥å¿—ç³»ç»Ÿå·²åœ¨ lifespan ä¸­åˆå§‹åŒ– =====
2025-10-06 23:37:51,224 - INFO [SERVER] - æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º: DEBUG
2025-10-06 23:37:51,224 - INFO [SERVER] - æ—¥å¿—æ–‡ä»¶è·¯å¾„: C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\config\..\logs\app.log
2025-10-06 23:37:51,224 - INFO [SERVER] - æ§åˆ¶å°æ—¥å¿—å¤„ç†å™¨å·²æ·»åŠ ã€‚
2025-10-06 23:37:51,225 - INFO [SERVER] - Print é‡å®šå‘ (ç”± SERVER_REDIRECT_PRINT ç¯å¢ƒå˜é‡æ§åˆ¶): ç¦ç”¨
2025-10-06 23:37:51,225 - INFO [SERVER] - API keys and global locks initialized.
2025-10-06 23:37:51,226 - INFO [SERVER] - No proxy configured for Playwright.
C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\api_utils\app.py:207: RuntimeWarning: coroutine 'load_excluded_models' was never awaited
  load_excluded_models(EXCLUDED_MODELS_FILENAME)
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-10-06 23:37:51,229 - INFO [SERVER] - Starting AI Studio Proxy Server...
2025-10-06 23:37:51,229 - INFO [SERVER] - Starting Playwright...
2025-10-06 23:37:51,961 - INFO [SERVER] - Playwright started.
2025-10-06 23:37:51,961 - INFO [SERVER] - Connecting to browser at: ws://localhost:9222/324a9b936b146bf616b2a4f54ac170a7
2025-10-06 23:37:52,028 - INFO [SERVER] - Connected to browser: 135.0.1-beta.24
2025-10-06 23:37:52,028 - INFO [SERVER] - Initialising Qwen chat page.
2025-10-06 23:37:52,028 - INFO [SERVER] - Detected launch mode: debug
2025-10-06 23:37:52,029 - INFO [SERVER] - Using storage state: C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\auth_profiles\active\qwen.json
2025-10-06 23:37:58,674 - INFO [SERVER] - Navigating to https://chat.qwen.ai/
2025-10-06 23:38:32,404 - ERROR [SERVER] - Failed to prepare the Qwen chat page: Qwen chat input did not become visible in time.
Traceback (most recent call last):
  File "C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\browser_utils\initialization.py", line 236, in _wait_for_chat_ready
    await expect_async(page.locator("#chat-input")).to_be_visible(timeout=20000)
  File "C:\Users\mansi\AppData\Local\pypoetry\Cache\virtualenvs\aistudioproxyapi-AmwmgP_5-py3.12\Lib\site-packages\playwright\async_api\_generated.py", line 20190, in to_be_visible
    await self._impl_obj.to_be_visible(visible=visible, timeout=timeout)
  File "C:\Users\mansi\AppData\Local\pypoetry\Cache\virtualenvs\aistudioproxyapi-AmwmgP_5-py3.12\Lib\site-packages\playwright\_impl\_assertions.py", line 716, in to_be_visible
    await self._expect_impl(
  File "C:\Users\mansi\AppData\Local\pypoetry\Cache\virtualenvs\aistudioproxyapi-AmwmgP_5-py3.12\Lib\site-packages\playwright\_impl\_assertions.py", line 74, in _expect_impl
    raise AssertionError(
AssertionError: Locator expected to be visible
Actual value: <element(s) not found>
Call log:
  - LocatorAssertions.to_be_visible with timeout 20000ms
  - waiting for locator('#chat-input')


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\browser_utils\initialization.py", line 294, in _initialize_page_logic
    await _wait_for_chat_ready(page, loop, target_host)
  File "C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\browser_utils\initialization.py", line 238, in _wait_for_chat_ready
    raise RuntimeError("Qwen chat input did not become visible in time.") from exc
RuntimeError: Qwen chat input did not become visible in time.
2025-10-06 23:38:32,406 - WARNING [SERVER] - [init_failure] Unable to capture snapshot â€“ page unavailable.
2025-10-06 23:38:32,445 - ERROR [SERVER] - Page initialization failed.
2025-10-06 23:38:32,445 - CRITICAL [SERVER] - Application startup failed: Failed to initialize browser/page, worker not started.
Traceback (most recent call last):
  File "C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\api_utils\app.py", line 221, in lifespan
    raise RuntimeError("Failed to initialize browser/page, worker not started.")
RuntimeError: Failed to initialize browser/page, worker not started.
2025-10-06 23:38:32,446 - INFO [SERVER] - Shutting down resources...
2025-10-06 23:38:32,454 - INFO [SERVER] - Browser connection closed.
2025-10-06 23:38:32,471 - INFO [SERVER] - Playwright stopped.
2025-10-06 23:38:32,472 - INFO [SERVER] - Shutting down server...
2025-10-06 23:38:32,472 - INFO [SERVER] - Shutting down resources...
2025-10-06 23:38:32,472 - INFO [SERVER] - Playwright stopped.
å·²æ¢å¤ server.py çš„åŸå§‹ stdout å’Œ stderr æµã€‚
å·²æ¢å¤ server.py çš„åŸå§‹ stdout å’Œ stderr æµã€‚
2025-10-06 23:38:32,472 - INFO [SERVER] - Server shutdown complete.
Traceback (most recent call last):
  File "C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\api_utils\app.py", line 221, in lifespan
    raise RuntimeError("Failed to initialize browser/page, worker not started.")
RuntimeError: Failed to initialize browser/page, worker not started.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\mansi\AppData\Local\pypoetry\Cache\virtualenvs\aistudioproxyapi-AmwmgP_5-py3.12\Lib\site-packages\starlette\routing.py", line 692, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mansi\AppData\Local\Programs\Python\Python312\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI\api_utils\app.py", line 229, in lifespan
    raise RuntimeError(f"Application startup failed: {e}") from e
RuntimeError: Application startup failed: Failed to initialize browser/page, worker not started.

Application startup failed. Exiting.
2025-10-06 23:38:32,476 - INFO - Uvicorn æˆ–å…¶å­ç³»ç»Ÿé€šè¿‡ sys.exit(3) é€€å‡ºã€‚
2025-10-06 23:38:32,476 - INFO - ğŸš€ Camoufox å¯åŠ¨å™¨ä¸»é€»è¾‘æ‰§è¡Œå®Œæ¯• ğŸš€
2025-10-06 23:38:32,477 - INFO - --- å¼€å§‹æ‰§è¡Œæ¸…ç†ç¨‹åº (launch_camoufox.py) ---
2025-10-06 23:38:32,477 - INFO - æ­£åœ¨ç»ˆæ­¢ Camoufox å†…éƒ¨å­è¿›ç¨‹ (PID: 93380)...
2025-10-06 23:38:32,477 - INFO - è¿›ç¨‹æ ‘ (PID: 93380) å‘é€ç»ˆæ­¢è¯·æ±‚
SUCCESS: Sent termination signal to process with PID 15340, child of PID 90236.
ERROR: The process with PID 89300 (child process of PID 90236) could not be terminated.
Reason: This process can only be terminated forcefully (with /F option).
SUCCESS: Sent termination signal to process with PID 92196, child of PID 90236.
ERROR: The process with PID 49044 (child process of PID 90236) could not be terminated.
Reason: This process can only be terminated forcefully (with /F option).
ERROR: The process with PID 92456 (child process of PID 90236) could not be terminated.
Reason: This process can only be terminated forcefully (with /F option).
ERROR: The process with PID 90236 (child process of PID 91444) could not be terminated.
Reason: One or more child processes of this process were still running.
ERROR: The process with PID 91444 (child process of PID 81020) could not be terminated.
Reason: One or more child processes of this process were still running.
ERROR: The process with PID 81020 (child process of PID 94156) could not be terminated.
Reason: One or more child processes of this process were still running.
ERROR: The process with PID 94156 (child process of PID 93380) could not be terminated.
Reason: One or more child processes of this process were still running.
ERROR: The process with PID 93380 (child process of PID 43432) could not be terminated.
Reason: One or more child processes of this process were still running.
2025-10-06 23:38:38,292 - WARNING -   âš ï¸ Camoufox (PID: 93380) SIGTERM è¶…æ—¶ã€‚æ­£åœ¨å‘é€ SIGKILL å¼ºåˆ¶ç»ˆæ­¢...
2025-10-06 23:38:38,292 - INFO -   å¼ºåˆ¶æ€æ­» Camoufox è¿›ç¨‹æ ‘ (PID: 93380)
SUCCESS: The process with PID 15340 (child process of PID 90236) has been terminated.
SUCCESS: The process with PID 89300 (child process of PID 90236) has been terminated.
SUCCESS: The process with PID 92196 (child process of PID 90236) has been terminated.
SUCCESS: The process with PID 49044 (child process of PID 90236) has been terminated.
SUCCESS: The process with PID 92456 (child process of PID 90236) has been terminated.
SUCCESS: The process with PID 90236 (child process of PID 91444) has been terminated.
SUCCESS: The process with PID 91444 (child process of PID 81020) has been terminated.
SUCCESS: The process with PID 81020 (child process of PID 94156) has been terminated.
SUCCESS: The process with PID 94156 (child process of PID 93380) has been terminated.
SUCCESS: The process with PID 93380 (child process of PID 43432) has been terminated.
2025-10-06 23:38:39,083 - INFO -   âœ“ Camoufox (PID: 93380) å·²é€šè¿‡ SIGKILL æˆåŠŸç»ˆæ­¢ã€‚
2025-10-06 23:38:39,084 - INFO - --- æ¸…ç†ç¨‹åºæ‰§è¡Œå®Œæ¯• (launch_camoufox.py) ---
PS C:\Users\mansi\new\gorursunuzsiz\AIstudioProxyAPI>
